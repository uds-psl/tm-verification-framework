<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">PslBase.Bijection</span> <span class="id" title="library">MetaCoq.Template.All</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.Ascii.html#"><span class="id" title="library">Strings.Ascii</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Undecidability.L</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Undecidability.L.Prelim.StringBase.html#"><span class="id" title="library">Prelim.StringBase</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Undecidability.L.Tactics</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Undecidability.L.Tactics.Lproc.html#"><span class="id" title="library">Lproc</span></a> <a class="idref" href="Undecidability.L.Tactics.Computable.html#"><span class="id" title="library">Computable</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#"><span class="id" title="library">ComputableTime</span></a> <a class="idref" href="Undecidability.L.Tactics.Lsimpl.html#"><span class="id" title="library">Lsimpl</span></a> <a class="idref" href="Undecidability.L.Tactics.mixedTactics.html#"><span class="id" title="library">mixedTactics</span></a> <a class="idref" href="Undecidability.L.Tactics.Lbeta.html#"><span class="id" title="library">Lbeta</span></a> <a class="idref" href="Undecidability.L.Tactics.Lrewrite.html#"><span class="id" title="library">Lrewrite</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.setoid_ring.Ring.html#"><span class="id" title="library">Ring</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Arith.Arith.html#"><span class="id" title="library">Arith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab330"></a><h2 class="section">Tactics proving correctness</h2>

</div>
<div class="code">
<span class="id" title="keyword">Module</span> <a name="Intern"><span class="id" title="module">Intern</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">visibleHead</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">h</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">visibleHead</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">fold_encs</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>:<span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">x</span>;<span class="id" title="var">fold_encs</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span>:@<a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> @<a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">unfold</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="tactic">at</span> 1; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">H</span>);<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRem</span> <span class="id" title="var">P</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span>[<a class="idref" href="Undecidability.L.L.html#rho"><span class="id" title="definition">rho</span></a> ?<span class="id" title="var">s</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">rP</span> := <span class="id" title="tactic">fresh</span> "rP" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rP</span>:=<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="Undecidability.L.L.html#proc"><span class="id" title="definition">proc</span></a> <span class="id" title="var">rP</span>);[<span class="id" title="tactic">unfold</span> <span class="id" title="var">rP</span>;<span class="id" title="tactic">solve</span> [<span class="id" title="var">Lproc</span>]|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">P</span> := <a class="idref" href="Undecidability.L.L.html#rho"><span class="id" title="definition">rho</span></a> <span class="id" title="var">rP</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="Undecidability.L.L.html#proc"><span class="id" title="definition">proc</span></a> <span class="id" title="var">P</span>);[<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>;<span class="id" title="tactic">solve</span> [<span class="id" title="var">Lproc</span>]|]]<br/>
  <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recStepInit</span> <span class="id" title="var">P</span>:=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">lazy</span> [<span class="id" title="var">P</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">P</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Undecidability.L.L.html#rho"><span class="id" title="definition">rho</span></a> ?<span class="id" title="var">rP</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.L.html#evalLe"><span class="id" title="definition">evalLe</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">loop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Prelim.ARS.html#pow"><span class="id" title="definition">ARS.pow</span></a> <a class="idref" href="Undecidability.L.L.html#step"><span class="id" title="inductive">step</span></a> <span class="id" title="var">_</span> (<a class="idref" href="Undecidability.L.L.html#app"><span class="id" title="constructor">app</span></a> <span class="id" title="var">P</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.Lsimpl.html#rho_correctPow"><span class="id" title="lemma">rho_correctPow</span></a>;<span class="id" title="var">now</span> <span class="id" title="var">Lproc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Prelim.ARS.html#pow"><span class="id" title="definition">ARS.pow</span></a> <a class="idref" href="Undecidability.L.L.html#step"><span class="id" title="inductive">step</span></a> <span class="id" title="var">_</span> (<a class="idref" href="Undecidability.L.L.html#app"><span class="id" title="constructor">app</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.L.html#pow_step_congL"><span class="id" title="instance">pow_step_congL</span></a>;[<span class="id" title="var">loop</span>|<span class="id" title="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.L.html#evalLe_trans"><span class="id" title="lemma">evalLe_trans</span></a>;[<span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.L.html#pow_redLe_subrelation"><span class="id" title="instance">pow_redLe_subrelation</span></a>;<span class="id" title="var">loop</span>|<span class="id" title="tactic">fold</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">rP</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.L.html#evalIn"><span class="id" title="definition">evalIn</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">loop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Prelim.ARS.html#pow"><span class="id" title="definition">ARS.pow</span></a> <a class="idref" href="Undecidability.L.L.html#step"><span class="id" title="inductive">step</span></a> <span class="id" title="var">_</span> (<a class="idref" href="Undecidability.L.L.html#app"><span class="id" title="constructor">app</span></a> <span class="id" title="var">P</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.Lsimpl.html#rho_correctPow"><span class="id" title="lemma">rho_correctPow</span></a>;<span class="id" title="var">now</span> <span class="id" title="var">Lproc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Prelim.ARS.html#pow"><span class="id" title="definition">ARS.pow</span></a> <a class="idref" href="Undecidability.L.L.html#step"><span class="id" title="inductive">step</span></a> <span class="id" title="var">_</span> (<a class="idref" href="Undecidability.L.L.html#app"><span class="id" title="constructor">app</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.L.html#pow_step_congL"><span class="id" title="instance">pow_step_congL</span></a>;[<span class="id" title="var">loop</span>|<span class="id" title="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.L.html#evalIn_trans"><span class="id" title="lemma">evalIn_trans</span></a>;[<span class="id" title="var">loop</span>|<span class="id" title="tactic">fold</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">rP</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.L.html#eval"><span class="id" title="definition">eval</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">loop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Prelim.ARS.html#star"><span class="id" title="inductive">ARS.star</span></a> <a class="idref" href="Undecidability.L.L.html#step"><span class="id" title="inductive">step</span></a> (<a class="idref" href="Undecidability.L.L.html#app"><span class="id" title="constructor">app</span></a> <span class="id" title="var">P</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.Lsimpl.html#rho_correct"><span class="id" title="lemma">rho_correct</span></a>;<span class="id" title="var">now</span> <span class="id" title="var">Lproc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Prelim.ARS.html#star"><span class="id" title="inductive">ARS.star</span></a> <a class="idref" href="Undecidability.L.L.html#step"><span class="id" title="inductive">step</span></a> (<a class="idref" href="Undecidability.L.L.html#app"><span class="id" title="constructor">app</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.L.html#star_step_app_proper"><span class="id" title="instance">star_step_app_proper</span></a>;[<span class="id" title="var">loop</span>|<span class="id" title="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.Tactics.Lbeta.html#eval_helper"><span class="id" title="lemma">eval_helper</span></a>;[<span class="id" title="var">loop</span>|<span class="id" title="tactic">fold</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">rP</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recStepUnnamed</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">P</span> := <a class="idref" href="Undecidability.L.L.html#rho"><span class="id" title="definition">rho</span></a> <span class="id" title="var">_</span> |- ?<span class="id" title="var">G</span> ] =&gt; <span class="id" title="var">recStepInit</span> <span class="id" title="var">P</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destructRefine</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- ?<span class="id" title="var">R</span> ?<span class="id" title="var">s</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [<span class="id" title="keyword">match</span> ?<span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> <span class="id" title="keyword">end</span>]=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>:<span class="id" title="var">R</span> <span class="id" title="var">_</span> ((<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span>:<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>)) <span class="id" title="var">x</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;refine&nbsp;index&nbsp;if&nbsp;applicable*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">R</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(?<span class="id" title="var">R'</span> ?<span class="id" title="var">i</span>) =&gt; <span class="id" title="var">tryif</span> <span class="id" title="var">is_evar</span> <span class="id" title="var">i</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>:<span class="id" title="var">R'</span> ((<span class="id" title="keyword">fun</span> (<span class="id" title="var">y</span>:<span class="id" title="var">t</span>) <span class="comment">(*(_&nbsp;:&nbsp;x=y)*)</span> =&gt; <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>)) <span class="id" title="var">x</span> )<span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">R2</span> ?<span class="id" title="var">i</span> ?<span class="id" title="var">s</span> ?<span class="id" title="var">t</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">i'</span>:= <span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="keyword">zeta</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>:<span class="id" title="var">R2</span> <span class="id" title="var">i'</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) + <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- ?<span class="id" title="var">G</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">G'</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="var">R2</span> <span class="id" title="var">i'</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> <span class="id" title="tactic">idtac</span> "could not refine" <span class="id" title="var">G</span> "with" <span class="id" title="var">G'</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">eq</span> := <span class="id" title="tactic">fresh</span> "eq" <span class="id" title="tactic">in</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">extractCorrectCrush</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span>(<span class="id" title="tactic">repeat</span> <span class="id" title="var">destructRefine</span>;<span class="id" title="var">Lsimpl</span>).<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">shelveIfUnsolved</span> <span class="id" title="var">msg</span>:= <span class="id" title="tactic">first</span>[<span class="id" title="keyword">let</span> <span class="id" title="var">n</span>:= <span class="id" title="var">numgoals</span> <span class="id" title="tactic">in</span> <span class="id" title="var">guard</span> <span class="id" title="var">n</span>=0|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- ?<span class="id" title="var">G</span> =&gt; <span class="id" title="tactic">idtac</span> "Could not solve some subgoal("<span class="id" title="var">msg</span>"):";<span class="id" title="tactic">idtac</span> <span class="id" title="var">G</span>;<span class="id" title="var">shelve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">ugly_fix_fix</span> <span class="id" title="var">IH</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;we&nbsp;must&nbsp;destruct&nbsp;to&nbsp;allow&nbsp;the&nbsp;fix&nbsp;to&nbsp;reduce...*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 1<br/>
&nbsp;&nbsp;| 1 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 4<br/>
&nbsp;&nbsp;| 2 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 7<br/>
&nbsp;&nbsp;| 3 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 10<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := <span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> (1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a>3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a><span class="id" title="var">n</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1000 "please add '| "<span class="id" title="var">n</span>" =&gt; fix IH"<span class="id" title="var">m</span>"'" " in the definition of Ltac-tactic ugly_fix_fix!"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">ugly_fix_fix2</span> <span class="id" title="var">IH</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;we&nbsp;must&nbsp;destruct&nbsp;to&nbsp;allow&nbsp;the&nbsp;fix&nbsp;to&nbsp;reduce...*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 1<br/>
&nbsp;&nbsp;| 1 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 5<br/>
&nbsp;&nbsp;| 2 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 9<br/>
&nbsp;&nbsp;| 3 =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">IH</span> 13<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := <span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> (1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a>4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a><span class="id" title="var">n</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1000 "please add '| "<span class="id" title="var">n</span>" =&gt; fix IH"<span class="id" title="var">m</span>"'" " in the definition of Ltac-tactic ugly_fix_fix2!"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">intro_to_assumed</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tx</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">x</span>;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>;<span class="id" title="var">revert</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span>:<span class="id" title="var">tx</span>), <span class="id" title="var">_</span>:<span class="id" title="keyword">Prop</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span>;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">x</span>);<span class="id" title="var">lock</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">split_assumed</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>|<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>];<span class="id" title="var">lock</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">clean_assumed</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> (<span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a><span class="id" title="var">_</span>) |- ?<span class="id" title="var">G</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<span class="id" title="var">lock</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">is_assumed_add</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- ?<span class="id" title="var">G</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">H</span>);<span class="id" title="var">shelve</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">is_assumed</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- ?<span class="id" title="var">G</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">refine</span> <span class="id" title="var">H</span>;<span class="id" title="var">shelve</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">close_assumed</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- ?<span class="id" title="var">G</span>  =&gt;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">assert</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;a&nbsp;non-recursive&nbsp;step*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">cstep'</span> <span class="id" title="var">extractSimp</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> "x" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computes"><span class="id" title="definition">computes</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">match</span> ?<span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> <span class="id" title="keyword">end</span>)=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">eq</span> := <span class="id" title="tactic">fresh</span> "eq" <span class="id" title="tactic">in</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computes"><span class="id" title="definition">computes</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyArr"><span class="id" title="constructor">TyArr</span></a> ?<span class="id" title="var">tt1</span> ?<span class="id" title="var">tt2</span>) ?<span class="id" title="var">f</span> ?<span class="id" title="var">intF</span>=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">fRep</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="keyword">ltac</span>:(<span class="id" title="var">quote_term</span> <span class="id" title="var">f</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="tactic">exact</span> <span class="id" title="var">x</span>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">fRep</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;potentially&nbsp;recursive&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">Ast.tFix</span> (<span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">fail</span> 1000 "mutual recursion not supported"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">Ast.tFix</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><span class="id" title="constructor">BasicAst.mkdef</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><span class="comment">(*&lt;-dtype*)</span> <span class="id" title="var">_</span><span class="comment">(*&lt;-dbody*)</span> ?<span class="id" title="var">recArg</span><span class="comment">(*&lt;-recArg*)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a> 0 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">let</span> <span class="id" title="var">P</span> := <span class="id" title="tactic">fresh</span> "P" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">recRem</span> <span class="id" title="var">P</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#computesExpStart"><span class="id" title="lemma">computesExpStart</span></a>;[<span class="id" title="tactic">solve</span> [<span class="id" title="var">Lproc</span>]|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">n</span>:= (<span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">recArg</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">step</span> <span class="id" title="var">n</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> ?<span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#computesExpStep"><span class="id" title="lemma">computesExpStep</span></a>;[<span class="id" title="tactic">try</span> <span class="id" title="var">recStep</span> <span class="id" title="var">P</span>;<span class="id" title="var">extractSimp</span> <span class="id" title="tactic">idtac</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos5"|<span class="id" title="var">Lproc</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos6"|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*simple&nbsp;notypeclasses&nbsp;refine&nbsp;(_:computes&nbsp;(_&nbsp;~&gt;&nbsp;_)&nbsp;_&nbsp;_&nbsp;(fun&nbsp;x&nbsp;xInt&nbsp;xNorm&nbsp;=&gt;&nbsp;(_,_)));try&nbsp;exact&nbsp;tt;shelve_unifiable;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> "x" <span class="id" title="tactic">in</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInt</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Int" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInts</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Ints" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">xInt</span> <span class="id" title="keyword">with</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#Build_computable"><span class="id" title="constructor">Build_computable</span></a> <span class="id" title="var">xInts</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">xInts</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.Computable.html#computes"><span class="id" title="definition">computes</span></a> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyB"><span class="id" title="constructor">TyB</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">reg</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext_is_enc"><span class="id" title="lemma">ext_is_enc</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#Build_computable"><span class="id" title="constructor">Build_computable</span></a> <span class="id" title="var">xInts</span>)) <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<span class="id" title="tactic">assert</span> (<span class="id" title="var">xInt</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">assert</span> (<span class="id" title="var">xInts</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Undecidability.L.Tactics.Computable.html#computes"><span class="id" title="definition">computes</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyArr"><span class="id" title="constructor">TyArr</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">step</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">x</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">step</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">IH</span> := <span class="id" title="tactic">fresh</span> "IH" <span class="id" title="var">P</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ugly_fix_fix</span> <span class="id" title="var">IH</span> <span class="id" title="var">recArg</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">loop</span> <span class="id" title="var">n</span> := <span class="comment">(*&nbsp;destruct&nbsp;the&nbsp;struct-recursive&nbsp;argument*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 =&gt; <span class="id" title="tactic">intros</span> [] ? ?<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> ?<span class="id" title="var">n'</span> =&gt; <span class="id" title="tactic">intros</span> ? ? ?;<span class="id" title="var">loop</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">loop</span> <span class="id" title="var">recArg</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">try</span> <span class="id" title="var">recStep</span> <span class="id" title="var">P</span>;<span class="id" title="var">extractSimp</span> <span class="id" title="tactic">idtac</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos7"|]))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;non-recursive&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInt</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Int" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xNorm</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Norm" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInts</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Ints" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vProc</span> := <span class="id" title="tactic">fresh</span> "vProc" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*simple&nbsp;notypeclasses&nbsp;refine&nbsp;(_:computes&nbsp;(tt1&nbsp;~&gt;&nbsp;tt2)&nbsp;_&nbsp;_&nbsp;(fun&nbsp;x&nbsp;xInt&nbsp;xNorm&nbsp;=&gt;&nbsp;(_,_)));try&nbsp;exact&nbsp;tt;shelve_unifiable;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#computesTyArr"><span class="id" title="lemma">computesTyArr</span></a>;[<span class="id" title="tactic">try</span> <span class="id" title="var">Lproc</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos1"|<span class="id" title="tactic">idtac</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">xInt</span> <span class="id" title="keyword">with</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#Build_computable"><span class="id" title="constructor">Build_computable</span></a> <span class="id" title="var">xInts</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">tt1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyB"><span class="id" title="constructor">TyB</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">rewrite</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext_is_enc"><span class="id" title="lemma">ext_is_enc</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#Build_computable"><span class="id" title="constructor">Build_computable</span></a> <span class="id" title="var">xInts</span>)) <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<span class="id" title="tactic">assert</span> (<span class="id" title="var">xInt</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">assert</span> (<span class="id" title="var">xInts</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<span class="id" title="tactic">split</span>;[<span class="id" title="var">extractSimp</span> <span class="id" title="tactic">idtac</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos2" | <span class="id" title="tactic">intros</span> <span class="id" title="var">vProc</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<br/>
&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computes"><span class="id" title="definition">computes</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyB"><span class="id" title="constructor">TyB</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> ?<span class="id" title="var">t</span>=&gt; <span class="id" title="var">is_ground</span> <span class="id" title="var">t</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#computesTyB"><span class="id" title="lemma">computesTyB</span></a><br/>
<br/>
&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computes"><span class="id" title="definition">computes</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)=&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#extCorrect"><span class="id" title="method">extCorrect</span></a><br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;with&nbsp;time&nbsp;bounds:&nbsp;*)</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">match</span> ?<span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> <span class="id" title="keyword">end</span>) <span class="id" title="var">_</span>=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>;<span class="id" title="var">revert</span> <span class="id" title="var">H</span>;(<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a>(<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span>:<span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span>):<span class="id" title="keyword">Prop</span>) <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>;<span class="id" title="var">lock</span> <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">eq</span> := <span class="id" title="tactic">fresh</span> "eq" <span class="id" title="tactic">in</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyArr"><span class="id" title="constructor">TyArr</span></a> ?<span class="id" title="var">tt1</span> ?<span class="id" title="var">tt2</span>) ?<span class="id" title="var">f</span> ?<span class="id" title="var">intF</span> ?<span class="id" title="var">T</span>=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">fRep</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="keyword">ltac</span>:(<span class="id" title="var">quote_term</span> <span class="id" title="var">f</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="tactic">exact</span> <span class="id" title="var">x</span>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">fRep</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">Ast.tFix</span> (<span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">fail</span> 1000 "mutual recursion not supported"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">Ast.tFix</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><span class="id" title="constructor">BasicAst.mkdef</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><span class="comment">(*&lt;-dtype*)</span> <span class="id" title="var">_</span><span class="comment">(*&lt;-dbody*)</span> ?<span class="id" title="var">recArg</span><span class="comment">(*&lt;-recArg*)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a> 0 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">P</span> := <span class="id" title="tactic">fresh</span> "P" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H'</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">H</span> "'" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">recRem</span> <span class="id" title="var">P</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTimeExpStart"><span class="id" title="lemma">computesTimeExpStart</span></a>;[<span class="id" title="tactic">solve</span> [<span class="id" title="var">Lproc</span>]|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">n</span>:= (<span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">recArg</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">step</span> <span class="id" title="var">n</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> ?<span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> "x" <span class="id" title="tactic">in</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInt</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Int" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xT</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "T" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInts</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Ints" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">refine</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTimeExpStep"><span class="id" title="lemma">computesTimeExpStep</span></a> (<span class="id" title="var">fT</span>:=<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">xT</span> =&gt; <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="tactic">try</span> <span class="id" title="var">recStepUnnamed</span>;<span class="id" title="var">extractSimp</span> <span class="id" title="tactic">idtac</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos8"|<span class="id" title="var">Lproc</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos9"|]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>;<span class="id" title="var">is_assumed_add</span>|];<span class="id" title="var">clean_assumed</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*simple&nbsp;notypeclasses&nbsp;refine&nbsp;(_:computes&nbsp;(_&nbsp;~&gt;&nbsp;_)&nbsp;_&nbsp;_&nbsp;(fun&nbsp;x&nbsp;xInt&nbsp;xNorm&nbsp;=&gt;&nbsp;(_,_)));try&nbsp;exact&nbsp;tt;shelve_unifiable;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xT</span>; <span class="id" title="var">intro_to_assumed</span> <span class="id" title="var">x</span>;<span class="id" title="var">intro_to_assumed</span> <span class="id" title="var">xT</span>;<span class="id" title="tactic">intro</span> <span class="id" title="var">xInts</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">xInt</span> <span class="id" title="keyword">with</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#Build_computableTime"><span class="id" title="constructor">Build_computableTime</span></a> <span class="id" title="var">xInts</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">xInts</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyB"><span class="id" title="constructor">TyB</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">reg</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT_is_enc"><span class="id" title="lemma">extT_is_enc</span></a> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#Build_computableTime"><span class="id" title="constructor">Build_computableTime</span></a> <span class="id" title="var">xInts</span>)) <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xT</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<span class="id" title="tactic">assert</span> (<span class="id" title="var">xInt</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">assert</span> (<span class="id" title="var">xInts</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">assert</span> (<span class="id" title="var">xT</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyArr"><span class="id" title="constructor">TyArr</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>=&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">step</span> <span class="id" title="var">n'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">x</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xT</span> <span class="id" title="var">xInts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">step</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">IH</span> := <span class="id" title="tactic">fresh</span> "IH" <span class="id" title="var">P</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ugly_fix_fix2</span> <span class="id" title="var">IH</span> <span class="id" title="var">recArg</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">loop</span> <span class="id" title="var">n</span> := <span class="comment">(*&nbsp;destruct&nbsp;the&nbsp;struct-recursive&nbsp;argument*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">clean_assumed</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> "x" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xT</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "T" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> ? <span class="id" title="var">xT</span> ? ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tx</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">txT</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">xT</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>; <span class="id" title="var">revert</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span>:<span class="id" title="var">_</span>) (<span class="id" title="var">xT</span>:<span class="id" title="var">_</span>) , (<span class="id" title="var">_</span> :<span class="id" title="keyword">Prop</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> );<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">xT</span>);<span class="id" title="var">lock</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 =&gt; <span class="id" title="var">unlock</span> <span class="id" title="var">H</span>;<span class="id" title="var">revert</span> <span class="id" title="var">H</span>;(<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a>(<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span>:<span class="id" title="var">tx</span> =&gt; <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span>):<span class="id" title="keyword">Prop</span>) <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>;<span class="id" title="var">lock</span> <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> (<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>));<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>;(<span class="id" title="tactic">split</span>;<span class="id" title="var">unlock</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <a class="idref" href="Undecidability.L.L.html#evalLe"><span class="id" title="definition">evalLe</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<a class="idref" href="Undecidability.L.L.html#le_evalLe_proper"><span class="id" title="instance">le_evalLe_proper</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">_</span>);[<span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">H</span>);<span class="id" title="var">shelve</span>|<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<span class="id" title="var">lock</span> <span class="id" title="var">H</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">recStepUnnamed</span>;<span class="id" title="var">extractSimp</span> <span class="id" title="tactic">idtac</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos10"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<span class="id" title="var">lock</span> <span class="id" title="var">H</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> ?<span class="id" title="var">n'</span> =&gt; <span class="id" title="var">loop</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">loop</span> <span class="id" title="var">recArg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;non-recursive&nbsp;function*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInt</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Int" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xNorm</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Norm" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInts</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Time" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xInts</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "Ints" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xT</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">x</span> "T" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vProc</span> := <span class="id" title="tactic">fresh</span> "vProc" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*simple&nbsp;notypeclasses&nbsp;refine&nbsp;(_:computes&nbsp;(tt1&nbsp;~&gt;&nbsp;tt2)&nbsp;_&nbsp;_&nbsp;(fun&nbsp;x&nbsp;xInt&nbsp;xNorm&nbsp;=&gt;&nbsp;(_,_)));try&nbsp;exact&nbsp;tt;shelve_unifiable;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTimeTyArr_helper"><span class="id" title="lemma">computesTimeTyArr_helper</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">time</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">xT</span> =&gt; <span class="id" title="var">_</span>);[<span class="id" title="tactic">try</span> <span class="id" title="var">Lproc</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos3"|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">xT</span>;<span class="id" title="var">intro_to_assumed</span> <span class="id" title="var">x</span>;<span class="id" title="var">intro_to_assumed</span> <span class="id" title="var">xT</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">split_assumed</span>;[<span class="id" title="var">now</span> <span class="id" title="var">is_assumed</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">xInt</span> <span class="id" title="keyword">with</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#Build_computableTime"><span class="id" title="constructor">Build_computableTime</span></a> <span class="id" title="var">xInts</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">tt1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyB"><span class="id" title="constructor">TyB</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">rewrite</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT_is_enc"><span class="id" title="lemma">extT_is_enc</span></a> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#Build_computableTime"><span class="id" title="constructor">Build_computableTime</span></a> <span class="id" title="var">xInts</span>)) <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">xInt</span> <span class="id" title="var">xInts</span>;<span class="id" title="tactic">assert</span> (<span class="id" title="var">xInt</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">assert</span> (<span class="id" title="var">xInts</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>;<span class="id" title="tactic">split</span>;[<span class="id" title="var">extractSimp</span> <span class="id" title="tactic">idtac</span>;<span class="id" title="var">shelveIfUnsolved</span> "pos4"| <span class="id" title="tactic">intros</span> <span class="id" title="var">vProc</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;complexity:&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#TyB"><span class="id" title="constructor">TyB</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">tt</span>=&gt; <span class="id" title="var">is_ground</span> <span class="id" title="var">t</span>;<span class="id" title="var">close_assumed</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">tt</span>;<span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTimeTyB"><span class="id" title="lemma">computesTimeTyB</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |-<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extTCorrect"><span class="id" title="method">extTCorrect</span></a><br/>
<br/>
&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTime"><span class="id" title="definition">computesTime</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|  <span class="id" title="var">H</span> : <span class="id" title="definition">Lock</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computesTimeIfStart"><span class="id" title="lemma">computesTimeIfStart</span></a> (<span class="id" title="var">P</span>:= <span class="id" title="keyword">fun</span> <span class="id" title="var">fT</span> =&gt; <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">fT</span> := <span class="id" title="tactic">fresh</span> "fT" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">fT</span> <span class="id" title="var">H</span>; <span class="id" title="var">lock</span> <span class="id" title="var">H</span>|] <span class="comment">(*&nbsp;introduce&nbsp;the&nbsp;assumptions&nbsp;for&nbsp;the&nbsp;recurence&nbsp;equations&nbsp;to&nbsp;be&nbsp;collected&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "progress'" <span class="id" title="var">tactic</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">R</span> ?<span class="id" title="var">s</span> <span class="id" title="var">_</span> =&gt;<span class="id" title="tactic">idtac</span> "now";<span class="id" title="var">print_goal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span> <span class="id" title="var">tt</span>;<span class="id" title="tactic">idtac</span>"then";<span class="id" title="var">print_goal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id" title="var">R</span> <span class="id" title="var">s</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "noprogress"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">extractCorrectCrush_new</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lrewrite_new</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">progress</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">Intern.destructRefine</span>);<span class="id" title="var">Lrewrite_new</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">Lreflexivity</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">cstep</span> := <span class="id" title="var">cstep'</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <a class="idref" href="Undecidability.L.L.html#eval"><span class="id" title="definition">eval</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">extractCorrectCrush_new</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.L.html#evalLe"><span class="id" title="definition">evalLe</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">extractCorrectCrush_new</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="Undecidability.L.L.html#evalIn"><span class="id" title="definition">evalIn</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Lsimpl</span>;<span class="id" title="tactic">fail</span> "evalIn does not support full Lrewrite and should only occur when simplifying rho/recursion"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">G</span> =&gt; <span class="id" title="tactic">idtac</span> "cstep found unexpected" <span class="id" title="var">G</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">idtac</span>;[<span class="id" title="tactic">idtac</span> "could not simplify some occuring term, shelved instead"];<span class="id" title="var">shelve</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">computable_match</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- ?<span class="id" title="var">R</span> ?<span class="id" title="var">lhs</span> ?<span class="id" title="var">rhs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">lhs</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [@<a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">reg</span> ?<span class="id" title="var">x</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">encf</span> := (<span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">reg</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">reg</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">encf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<span class="id" title="var">enc</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">change</span> <span class="id" title="var">encf</span> <span class="id" title="keyword">with</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#enc"><span class="id" title="method">enc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">reg</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fold_encs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lsimpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">infer_instances</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span> [ <a class="idref" href="Undecidability.L.Tactics.Extract.html#int_ext"><span class="id" title="definition">int_ext</span></a> ?<span class="id" title="var">t</span> ] ] =&gt; <span class="id" title="tactic">first</span> [<span class="id" title="tactic">change</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#int_ext"><span class="id" title="definition">int_ext</span></a> <span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> <span class="id" title="var">t</span>) | <span class="id" title="tactic">fail</span> 3 "Could not fold int-instance for " <span class="id" title="var">t</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span> [ <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> ?<span class="id" title="var">t</span> ] ] =&gt; <span class="id" title="tactic">first</span> [<span class="id" title="tactic">change</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> <span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> <span class="id" title="var">t</span>) | <span class="id" title="tactic">fail</span> 3 "Could not fold int-instance for " <span class="id" title="var">t</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">infer_instancesT</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span> [ <a class="idref" href="Undecidability.L.Tactics.Extract.html#int_ext"><span class="id" title="definition">int_ext</span></a> ?<span class="id" title="var">t</span> ] ] =&gt; <span class="id" title="tactic">first</span> [<span class="id" title="tactic">change</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#int_ext"><span class="id" title="definition">int_ext</span></a> <span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> <span class="id" title="var">t</span>) | <span class="id" title="tactic">fail</span> 3 "Could not fold extT-instance for " <span class="id" title="var">t</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span> [ <a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> ?<span class="id" title="var">t</span> ] ] =&gt; <span class="id" title="tactic">first</span> [<span class="id" title="tactic">change</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#ext"><span class="id" title="method">ext</span></a> <span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#extT"><span class="id" title="method">extT</span></a> <span class="id" title="var">t</span>) | <span class="id" title="tactic">fail</span> 3 "Could not fold extT-instance for " <span class="id" title="var">t</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">computable_prepare</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">h</span> := <span class="id" title="var">visibleHead</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="var">is_const</span> <span class="id" title="var">h</span> <span class="id" title="keyword">then</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">h</span> <span class="id" title="keyword">else</span> <span class="id" title="tactic">idtac</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">computable_using_noProof</span> <span class="id" title="var">Lter</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computable"><span class="id" title="class">computable</span></a> ?<span class="id" title="var">t</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">Lter</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Lter</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t'</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">h</span> := <span class="id" title="var">visibleHead</span> <span class="id" title="var">t'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">h</span>;<span class="id" title="var">computable_prepare</span> <span class="id" title="var">t</span>;<span class="id" title="var">infer_instances</span><br/>
&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computableTime"><span class="id" title="class">computableTime</span></a> ?<span class="id" title="var">t</span> <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">Lter</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Lter</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t'</span> := (<span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">h</span> := <span class="id" title="var">visibleHead</span> <span class="id" title="var">t'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">h</span>; <span class="id" title="var">computable_prepare</span> <span class="id" title="var">t</span>; <span class="id" title="var">infer_instancesT</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">extractAs</span> <span class="id" title="var">s</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computable"><span class="id" title="class">computable</span></a> ?<span class="id" title="var">t</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">run_template_program</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#tmExtract"><span class="id" title="definition">tmExtract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;  <span class="id" title="tactic">pose</span> (<span class="id" title="var">s</span>:= ( <span class="id" title="var">e</span> : <a class="idref" href="Undecidability.L.Tactics.Extract.html#extracted"><span class="id" title="class">extracted</span></a> <span class="id" title="var">t</span>))))<br/>
&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computableTime"><span class="id" title="class">computableTime</span></a> ?<span class="id" title="var">t</span> <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">run_template_program</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#tmExtract"><span class="id" title="definition">tmExtract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="tactic">pose</span> (<span class="id" title="var">s</span>:= ( <span class="id" title="var">e</span> : <a class="idref" href="Undecidability.L.Tactics.Extract.html#extracted"><span class="id" title="class">extracted</span></a> <span class="id" title="var">t</span>))))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">extractThis</span> <span class="id" title="var">t</span> <span class="id" title="var">s</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">run_template_program</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#tmExtract"><span class="id" title="definition">tmExtract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;  <span class="id" title="tactic">pose</span> (<span class="id" title="var">s</span>:= ( <span class="id" title="var">e</span> : <a class="idref" href="Undecidability.L.Tactics.Extract.html#extracted"><span class="id" title="class">extracted</span></a> <span class="id" title="var">t</span>)))).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Intern"><span class="id" title="module">Intern</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Intern</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">register_inj</span> :=   <span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">destruct</span> 0;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">injection</span> <span class="id" title="var">eq</span> || <span class="id" title="tactic">discriminate</span> <span class="id" title="var">eq</span>);<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">f_equal</span>;<span class="id" title="tactic">auto</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="Undecidability.L.Tactics.Computable.html#inj_enc"><span class="id" title="method">inj_enc</span></a>;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>).<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">register_proc</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Undecidability.L.Tactics.Extract.html#enc_f"><span class="id" title="definition">enc_f</span></a>;<br/>
&nbsp;&nbsp;(((<span class="id" title="tactic">induction</span> 0 || <span class="id" title="tactic">intros</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">fold_encs</span>;<span class="id" title="var">Lproc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">register</span> <span class="id" title="var">encf</span> :=   <span class="id" title="tactic">refine</span> (@<a class="idref" href="Undecidability.L.Tactics.Computable.html#mk_registered"><span class="id" title="constructor">mk_registered</span></a> <span class="id" title="var">_</span> <span class="id" title="var">encf</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="tactic">induction</span> 0 || <span class="id" title="tactic">intros</span>);(<span class="id" title="keyword">let</span> <span class="id" title="var">f</span> := <span class="id" title="var">visibleHead</span> <span class="id" title="var">encf</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">f</span>;<span class="id" title="var">cbn</span> [<span class="id" title="var">f</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fold_encs</span>;<span class="id" title="var">Lproc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)) | <span class="id" title="tactic">try</span> <span class="id" title="var">register_inj</span>].<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "computable" "using" <span class="id" title="var">open_constr</span>(<span class="id" title="var">Lter</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">computable_using_noProof</span> <span class="id" title="var">Lter</span>;<span class="id" title="tactic">repeat</span> <span class="id" title="var">cstep</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "computable" "instead" <span class="id" title="var">open_constr</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="tactic">fresh</span> "s" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">extractThis</span> <span class="id" title="var">t</span> <span class="id" title="var">s</span>; <span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "computable" "infer" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computable"><span class="id" title="class">computable</span></a> ?<span class="id" title="var">t</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="keyword">constr</span>:(<a class="idref" href="Undecidability.L.Tactics.Extract.html#int_ext"><span class="id" title="definition">int_ext</span></a> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">int_ext</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">e'</span><br/>
&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computableTime"><span class="id" title="class">computableTime</span></a> ?<span class="id" title="var">t</span> <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="keyword">constr</span>:(<a class="idref" href="Undecidability.L.Tactics.Extract.html#int_ext"><span class="id" title="definition">int_ext</span></a> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">int_ext</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">e'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "extract" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">term</span> := <span class="id" title="tactic">fresh</span> "used_term" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">extractAs</span> <span class="id" title="var">term</span>;<span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">term</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "extract" "constructor":=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">term</span> := <span class="id" title="tactic">fresh</span> "used_term" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.Computable.html#computable"><span class="id" title="class">computable</span></a> ?<span class="id" title="var">t</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">run_template_program</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#tmExtractConstr'"><span class="id" title="definition">tmExtractConstr'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;  <span class="id" title="tactic">pose</span> (<span class="id" title="var">term</span>:= ( <span class="id" title="var">e</span> : <a class="idref" href="Undecidability.L.Tactics.Extract.html#extracted"><span class="id" title="class">extracted</span></a> <span class="id" title="var">t</span>)); <span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">term</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computableTime"><span class="id" title="class">computableTime</span></a> ?<span class="id" title="var">t</span> <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">run_template_program</span> (<a class="idref" href="Undecidability.L.Tactics.Extract.html#tmExtractConstr'"><span class="id" title="definition">tmExtractConstr'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt;  <span class="id" title="tactic">pose</span> (<span class="id" title="var">term</span>:= ( <span class="id" title="var">e</span> : <a class="idref" href="Undecidability.L.Tactics.Extract.html#extracted"><span class="id" title="class">extracted</span></a> <span class="id" title="var">t</span>)); <span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">term</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "extract" "match" := <span class="id" title="var">computable_match</span>.<br/>

<br/>
</div>

<div class="doc">
recRel_simplify 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="recRel_prettify_drop"><span class="id" title="lemma">recRel_prettify_drop</span></a> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#C"><span class="id" title="variable">C</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#B"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">))</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="recRel_prettify_forall"><span class="id" title="lemma">recRel_prettify_forall</span></a> <span class="id" title="var">X</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q"><span class="id" title="variable">Q</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">((</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q"><span class="id" title="variable">Q</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">))</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">firstorder</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="recRel_prettify_conj"><span class="id" title="lemma">recRel_prettify_conj</span></a> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">Q</span> <span class="id" title="var">Q'</span> : <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P"><span class="id" title="variable">P</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P'"><span class="id" title="variable">P'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q'"><span class="id" title="variable">Q'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P'"><span class="id" title="variable">P'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q'"><span class="id" title="variable">Q'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">firstorder</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="recRel_prettify_conj_drop_r"><span class="id" title="lemma">recRel_prettify_conj_drop_r</span></a> (<span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">Q'</span> : <span class="id" title="keyword">Prop</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q'"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P"><span class="id" title="variable">P</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P'"><span class="id" title="variable">P'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#P'"><span class="id" title="variable">P'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Q'"><span class="id" title="variable">Q'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">))</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">firstorder</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="recRel_prettify_rel"><span class="id" title="lemma">recRel_prettify_rel</span></a> <span class="id" title="var">X</span> <span class="id" title="var">R</span> (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> : <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#X"><span class="id" title="variable">X</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x'"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#y'"><span class="id" title="variable">y'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#R"><span class="id" title="variable">R</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x'"><span class="id" title="variable">x'</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#y'"><span class="id" title="variable">y'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#R"><span class="id" title="variable">R</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">firstorder</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRel_ring_simplify</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">R</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x'</span> := <span class="id" title="tactic">fresh</span> "x'" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">y'</span> := <span class="id" title="tactic">fresh</span> "y'" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">x'</span> : <span class="id" title="var">X</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">y'</span> : <span class="id" title="var">X</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#recRel_prettify_rel"><span class="id" title="lemma">recRel_prettify_rel</span></a> <span class="id" title="var">X</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ring_simplify</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">subst</span> <span class="id" title="var">x'</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">subst</span> <span class="id" title="var">y'</span>;<span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRel_descend_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#recRel_prettify_drop"><span class="id" title="lemma">recRel_prettify_drop</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#recRel_prettify_conj_drop_r"><span class="id" title="lemma">recRel_prettify_conj_drop_r</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#I"><span class="id" title="constructor">Logic.I</span></a> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#recRel_prettify_conj"><span class="id" title="lemma">recRel_prettify_conj</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span>:?<span class="id" title="var">t</span>),@?<span class="id" title="var">P</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> "x" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#recRel_prettify_forall"><span class="id" title="lemma">recRel_prettify_forall</span></a> <span class="id" title="var">t</span> <span class="id" title="var">P</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span>:<span class="id" title="var">t</span>) =&gt; <span class="id" title="var">_</span>) <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">match</span> ?<span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> <span class="id" title="keyword">end</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t</span> := <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>:(<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a>(<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : <span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>)) <span class="id" title="var">x</span> : <span class="id" title="keyword">Prop</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9b077c369e19739ef880736ba34623ff"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>)%<span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">recRel_ring_simplify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">exact</span> (@<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Classes.RelationClasses.html#impl_Reflexive"><span class="id" title="instance">impl_Reflexive</span></a> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRel_descend</span> := <span class="id" title="tactic">repeat</span> <span class="id" title="var">recRel_descend_step</span>;[&gt;<span class="id" title="tactic">idtac</span> "recRel_descend could not simplify";<span class="id" title="var">shelve</span>..].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRel_prettify_prepare</span> := <span class="id" title="var">cbn</span> [<span class="id" title="var">id</span> <span class="id" title="var">fst</span> <span class="id" title="var">snd</span>]; <span class="comment">(*reduce&nbsp;casts&nbsp;&amp;&nbsp;projections&nbsp;from&nbsp;complexity&nbsp;functions*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Program.Basics.html#apply"><span class="id" title="definition">Basics.apply</span></a>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRel_prettify</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">recRel_prettify_prepare</span>;[<span class="id" title="var">recRel_descend</span>|<span class="id" title="var">cbn</span> <span class="id" title="keyword">beta</span>].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">recRel_prettify2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<span class="id" title="var">timeComplexity</span> <span class="id" title="var">fst</span> <span class="id" title="var">snd</span>] <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">idtac</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">t</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="keyword">let</span> <span class="id" title="var">H</span>:= <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">_</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>)));<span class="id" title="var">cbn</span> [<span class="id" title="var">fst</span> <span class="id" title="var">snd</span>];<span class="id" title="var">ring_simplify</span>.<br/>

<br/>
<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solverecTry</span> :=       <span class="id" title="var">cbn</span> [<span class="id" title="var">timeComplexity</span>] <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">idtac</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">t</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="keyword">let</span> <span class="id" title="var">H</span>:= <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">_</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>);<span class="id" title="var">cbn</span> -[<span class="id" title="var">mult</span> <span class="id" title="var">plus</span>];<span class="id" title="tactic">try</span> <span class="id" title="var">ring_simplify</span>);<span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>).<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solverec</span> :=   <span class="id" title="tactic">try</span> <span class="id" title="tactic">abstract</span> (<span class="id" title="var">solverecTry</span>);<span class="id" title="var">solverecTry</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="cast_computable"><span class="id" title="lemma">cast_computable</span></a> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> `{<a class="idref" href="Undecidability.L.Tactics.Computable.html#registered"><span class="id" title="class">registered</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Y"><span class="id" title="variable">Y</span></a>} (<span class="id" title="var">cast</span> : <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">Hc</span> : <span class="id" title="definition">injective</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#cast"><span class="id" title="variable">cast</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">_</span> := <a class="idref" href="Undecidability.L.Tactics.Computable.html#registerAs"><span class="id" title="lemma">registerAs</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#cast"><span class="id" title="variable">cast</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Hc"><span class="id" title="variable">Hc</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.Computable.html#computable"><span class="id" title="class">computable</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#cast"><span class="id" title="variable">cast</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">t</span>:=<a class="idref" href="Undecidability.L.L.html#lam"><span class="id" title="constructor">lam</span></a> 0).<br/>
&nbsp;&nbsp;<span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="ead6f414f9e843f23469479f9eebddea"><span class="id" title="notation">&quot;</span></a>'computableTime' f" := (@<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computableTime"><span class="id" title="class">computableTime</span></a> <span class="id" title="var">_</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">let</span> <span class="id" title="var">t</span>:=<span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> : <a class="idref" href="Undecidability.L.Tactics.Computable.html#TT"><span class="id" title="class">TT</span></a> <span class="id" title="var">t</span>);<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>) <span class="id" title="var">f</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0,<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="cast_computableTime"><span class="id" title="lemma">cast_computableTime</span></a> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> `{<a class="idref" href="Undecidability.L.Tactics.Computable.html#registered"><span class="id" title="class">registered</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Y"><span class="id" title="variable">Y</span></a>} (<span class="id" title="var">cast</span> : <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">Hc</span> : <span class="id" title="definition">injective</span> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#cast"><span class="id" title="variable">cast</span></a>):<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">_</span> := <a class="idref" href="Undecidability.L.Tactics.Computable.html#registerAs"><span class="id" title="lemma">registerAs</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#cast"><span class="id" title="variable">cast</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#Hc"><span class="id" title="variable">Hc</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#ead6f414f9e843f23469479f9eebddea"><span class="id" title="notation">computableTime</span></a> <a class="idref" href="Undecidability.L.Tactics.ComputableTactics.html#cast"><span class="id" title="variable">cast</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">t</span>:=<a class="idref" href="Undecidability.L.L.html#lam"><span class="id" title="constructor">lam</span></a> 0).<br/>
&nbsp;&nbsp;<span class="id" title="var">computable</span> <span class="id" title="keyword">using</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solverec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">computable_casted_result</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- @<a class="idref" href="Undecidability.L.Tactics.Computable.html#computable"><span class="id" title="class">computable</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="var">notypeclasses</span> <span class="id" title="tactic">refine</span> (<a class="idref" href="Undecidability.L.Tactics.Computable.html#cast_registeredAs"><span class="id" title="lemma">cast_registeredAs</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ | | | |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> - [<span class="id" title="var">registerAs</span>];<span class="id" title="tactic">reflexivity</span>| ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span><br/>
&nbsp;&nbsp;| |- @<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#computableTime"><span class="id" title="class">ComputableTime.computableTime</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="var">notypeclasses</span> <span class="id" title="tactic">refine</span> (<a class="idref" href="Undecidability.L.Tactics.ComputableTime.html#cast_registeredAs_TimeComplexity"><span class="id" title="lemma">cast_registeredAs_TimeComplexity</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ | | | |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> - [<span class="id" title="var">registerAs</span>];<span class="id" title="tactic">reflexivity</span>| ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
